(this["webpackJsonpcovid-vaccine-notifier-v2"]=this["webpackJsonpcovid-vaccine-notifier-v2"]||[]).push([[0],{16:function(e,t,c){},18:function(e,t,c){},19:function(e,t,c){},20:function(e,t,c){},22:function(e,t,c){},23:function(e,t,c){"use strict";c.r(t);var n=c(1),i=c.n(n),s=c(7),a=c.n(s),r=(c(16),c(3)),l=c.n(r),o=c(8),d=c(2),j=(c(18),c(10)),u=c(6),b=c(5),h=(c(19),c(20),c(0));var O=function(e){var t=e.isPopupOpen,c=e.selectedCenter,n=e.closePopup,s=c.sessions;return t?a.a.createPortal(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{className:"overlay"}),Object(h.jsxs)("div",{className:"pop-up",children:[Object(h.jsx)("button",{onClick:n,children:"X"}),Object(h.jsx)("table",{className:"details-table",children:Object(h.jsxs)("tbody",{children:[Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{className:"details-head",children:"Center:"}),Object(h.jsx)("td",{children:c.name})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{className:"details-head",children:"Address:"}),Object(h.jsx)("td",{children:c.address})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{className:"details-head",children:"Pincode:"}),Object(h.jsx)("td",{children:c.pincode})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{className:"details-head",children:"Vaccine:"}),Object(h.jsx)("td",{children:c.sessions[0].vaccine})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{className:"details-head",children:"Fee:"}),"Free"===c.fee_type?Object(h.jsx)("td",{children:"Free"}):Object(h.jsxs)("td",{children:["\u20b9",c.vaccine_fees[0].fee]})]})]})}),Object(h.jsxs)("div",{children:[Object(h.jsx)("h4",{children:"All Sessions"}),Object(h.jsx)("div",{className:"sessions-table-container",children:Object(h.jsxs)("table",{className:"all-sessions-table",children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Date"}),Object(h.jsx)("th",{children:"Min.Age"}),Object(h.jsx)("th",{children:"Dose 1"}),Object(h.jsx)("th",{children:"Dose 2"})]})}),Object(h.jsx)("tbody",{children:i.a.Children.toArray(s.map((function(e){return Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:e.date}),Object(h.jsx)("td",{children:e.min_age_limit}),Object(h.jsx)("td",{children:e.available_capacity_dose1}),Object(h.jsx)("td",{children:e.available_capacity_dose2})]})})))})]})})]})]})]}),document.getElementById("modal-root")):null};var f=function(e){var t=e.vaccineCenters,c=Object(n.useState)(!1),s=Object(d.a)(c,2),a=s[0],r=s[1],l=Object(n.useState)(""),o=Object(d.a)(l,2),j=o[0],u=o[1],f=Object(n.useState)(""),x=Object(d.a)(f,2),m=x[0],v=x[1],p=Object(n.useState)([]),N=Object(d.a)(p,2),g=N[0],C=N[1];return Object(n.useEffect)((function(){C("name"===m?Object(b.a)(t).sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})):function(e){return e.sort((function(e,t){return new Date(e.sessions[0].date)-new Date(t.sessions[0].date)}))}(Object(b.a)(t)))}),[m,t]),Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("table",{className:"vaccine-list-table",children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{className:"col col-1",onClick:function(){v("date")},children:"Date"}),Object(h.jsx)("th",{className:"col col-2",onClick:function(){v("name")},children:"Center"}),Object(h.jsx)("th",{className:"col col-3",children:"Dose 1"}),Object(h.jsx)("th",{className:"col col-4",children:"Dose 2"}),Object(h.jsx)("th",{className:"col col-5",children:"Min.Age"}),Object(h.jsx)("th",{className:"col col-6",children:"Vaccine"}),Object(h.jsx)("th",{className:"col col-7",children:"Type"})]})}),Object(h.jsxs)("tbody",{className:"vaccine-table-body",children:[i.a.Children.toArray(g.map((function(e){return Object(h.jsxs)("tr",{onClick:function(){r(!0),u(e)},children:[Object(h.jsx)("td",{className:"col col-1",children:e.sessions[0].date}),Object(h.jsx)("td",{className:"col col-2",children:Object(h.jsxs)("div",{children:[e.name,",",e.block_name,",",e.pincode]})}),Object(h.jsx)("td",{className:"col col-3",children:e.sessions[0].available_capacity_dose1}),Object(h.jsx)("td",{className:"col col-4",children:e.sessions[0].available_capacity_dose2}),Object(h.jsx)("td",{className:"col col-5",children:e.sessions[0].min_age_limit}),Object(h.jsx)("td",{className:"col col-6",children:e.sessions[0].vaccine}),Object(h.jsx)("td",{className:"col col-7",children:e.fee_type})]})}))),Object(h.jsx)(O,{isPopupOpen:a,selectedCenter:j,closePopup:function(){return r(!1)}})]})]})})},x=function(e){return e<10?"0".concat(e):e},m=function(){var e=new Date,t=x(e.getHours()),c=x(e.getMinutes()),n=x(e.getSeconds());return"".concat(t,":").concat(c,":").concat(n)},v=function(){var e=new Date,t=x(e.getDate()),c=x(e.getMonth()+1),n=x(e.getFullYear());return"".concat(t,"-").concat(c,"-").concat(n)};function p(e,t){return function(){for(var e=arguments.length,t=new Array(e),c=0;c<e;c++)t[c]=arguments[c];return function(e){return t.reduce((function(e,t){return t(e)}),e)}}((r=e.pinCode,function(e){if(0===r)return e;var t=new RegExp(r,"g");return e.filter((function(e){return t.exec(e.pincode)?e:null}))}),(a=e.name,function(e){if(""===a)return e;var t=new RegExp(a,"gi");return e.filter((function(e){return t.exec(e.name)?e:null}))}),(s=e.vaccine,function(e){return"ALL"===s?e:e.filter((function(e){return e.sessions[0].vaccine===s?e:null}))}),(i=e.age,function(e){return 0===i?e:e.filter((function(e){return e.sessions[0].min_age_limit===i?e:null}))}),(n=e.fee,function(e){return"ALL"===n?e:e.filter((function(e){return e.fee_type===n?e:null}))}),(c=e.dose,function(e){return"ALL"===c?e:e.filter((function(e){if("dose1"===c){if(e.sessions[0].available_capacity_dose1>0)return e}else if("dose2"===c&&e.sessions[0].available_capacity_dose2>0)return e;return null}))}))(t);var c,n,i,s,a,r}c(22);var N={age:0,vaccine:"ALL",name:"",pinCode:0,fee:"ALL",dose:"ALL"};function g(e){var t=e.vaccineCenters,c=Object(n.useState)([]),s=Object(d.a)(c,2),a=s[0],r=s[1],l=Object(n.useState)(N),o=Object(d.a)(l,2),b=o[0],O=o[1],x=Object(n.useState)(!1),v=Object(d.a)(x,2),g=v[0],C=v[1];Object(n.useEffect)((function(){var e=p(b,t);g&&(Notification.requestPermission(),e.length>0&&("Notification"in window?"granted"===Notification.permission?new Notification("Vaccines are available!"):"denied"!==Notification.permission&&Notification.requestPermission().then((function(e){"granted"===e&&new Notification("Vaccines are available!")})):alert("This browser does not support desktop notification"),C(!1))),r(e)}),[b,t]);var y=function(e){"age"!==e.target.name?O(Object(u.a)(Object(u.a)({},b),Object(j.a)({},e.target.name,e.target.value))):O(Object(u.a)(Object(u.a)({},b),{},{age:parseInt(e.target.value)}))};return Object(h.jsxs)("div",{className:"VaccineCenterList",children:[Object(h.jsxs)("div",{className:"filter-container",children:[Object(h.jsxs)("div",{className:"radio-container",children:[Object(h.jsx)("div",{className:"switch-field",children:["0","18","40","45"].map((function(e){return Object(h.jsxs)(i.a.Fragment,{children:[Object(h.jsx)("input",{type:"radio",id:"age".concat(e),name:"age",value:e,onClick:y,defaultChecked:"0"===e}),Object(h.jsx)("label",{htmlFor:"age".concat(e),children:"0"===e?"ALL":e+"+"})]},e)}))}),Object(h.jsx)("div",{className:"switch-field",children:["All","Covishield","Covaxin","Sputnik V"].map((function(e){return Object(h.jsxs)(i.a.Fragment,{children:[Object(h.jsx)("input",{type:"radio",id:"vaccine".concat(e),name:"vaccine",value:e.toUpperCase(),onClick:y,defaultChecked:"All"===e}),Object(h.jsx)("label",{htmlFor:"vaccine".concat(e),children:e})]},e)}))}),Object(h.jsx)("div",{className:"switch-field",children:["All","Free","Paid"].map((function(e){return Object(h.jsxs)(i.a.Fragment,{children:[Object(h.jsx)("input",{type:"radio",id:"fee".concat(e),name:"fee",value:"All"===e?"ALL":e,onClick:y,defaultChecked:"All"===e}),Object(h.jsx)("label",{htmlFor:"fee".concat(e),children:e})]},e)}))}),Object(h.jsx)("div",{className:"switch-field",children:["All","Dose1","Dose2"].map((function(e){return Object(h.jsxs)(i.a.Fragment,{children:[Object(h.jsx)("input",{type:"radio",id:"dose".concat(e),name:"dose",value:"All"===e?"ALL":e.toLowerCase(),onClick:y,defaultChecked:"All"===e}),Object(h.jsx)("label",{htmlFor:"dose".concat(e),children:e})]},e)}))})]}),Object(h.jsxs)("div",{className:"secondary-filter-container",children:[Object(h.jsxs)("div",{className:"input-filter-container",children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:"name-filter",children:"Name"}),Object(h.jsx)("input",{type:"text",id:"name-filter",name:"name",onChange:y})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:"pin-filter",children:"Pincode"}),Object(h.jsx)("input",{type:"number",id:"pin-filter",name:"pinCode",onChange:y})]})]}),Object(h.jsxs)("div",{children:["Last refresh : ",m()]})]})]}),Object(h.jsx)("div",{className:"vaccine-list-table",children:0!==a.length?Object(h.jsx)(f,{vaccineCenters:a}):Object(h.jsxs)("div",{className:"notification-prompt",children:[Object(h.jsx)("h4",{children:"No vaccine centers available!"}),Object(h.jsx)("button",{disabled:!!g,onClick:function(){C(!0)},children:"Notify Me !"})]})})]})}var C=Object(n.memo)(g),y=function(e){var t=[];return e.forEach((function(e){var c=_(Object(b.a)(e.sessions));e.sessions=c,t.push(e)})),t.filter((function(e){return 0!==e.sessions.length}))},_=function(e){return e.filter((function(e){return e.available_capacity>0}))};var w=function(e){var t=e.getDistrict,c=e.selectedDistrict,s=Object(n.useState)([]),a=Object(d.a)(s,2),r=a[0],j=a[1],u=Object(n.useState)(!1),b=Object(d.a)(u,2),O=b[0],f=b[1],x=function(){var e=Object(o.a)(l.a.mark((function e(){var t,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://cdn-api.co-vin.in/api/v2/admin/location/districts/17");case 2:return t=e.sent,e.next=5,t.json();case 5:c=e.sent,j(c.districts);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){x()}),[]),Object(h.jsxs)("header",{children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"Covid Vaccine Notifier"}),Object(h.jsxs)("div",{className:"dropdown",children:[Object(h.jsx)("button",{onClick:function(){f(!O)},className:"dropbtn",children:c.district_name}),Object(h.jsx)("div",{id:"myDropdown",className:"dropdown-content",style:{display:O?"block":"none"},children:i.a.Children.toArray(r.map((function(e,c){return Object(h.jsx)("div",{onClick:function(e){!function(e,c){t(r[c]),f(!1)}(0,c)},children:e.district_name})})))})]})]}),Object(h.jsx)("div",{className:"cowin-link",children:Object(h.jsx)("button",{children:Object(h.jsx)("a",{href:"https://selfregistration.cowin.gov.in/",children:"Co-WIN"})})})]})},k={district_id:307,district_name:"Ernakulam"};var A=function(){var e=Object(n.useState)(null),t=Object(d.a)(e,2),c=t[0],i=t[1],s=Object(n.useState)(k),a=Object(d.a)(s,2),r=a[0],j=a[1],u=Object(n.useCallback)(Object(o.a)(l.a.mark((function e(){var t,c,n,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new URL("https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/calendarByDistrict")).searchParams.append("district_id",r.district_id),t.searchParams.append("date",v()),e.prev=3,e.next=6,fetch(t,{mode:"cors"});case 6:return c=e.sent,e.next=9,c.json();case 9:n=e.sent,s=y(n.centers),i(s),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[3,14]])}))),[r]);return Object(n.useEffect)((function(){u();var e=setInterval((function(){u()}),1e4);return function(){clearInterval(e)}}),[r,u]),Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(w,{getDistrict:function(e){return j(e)},selectedDistrict:r}),c&&Object(h.jsx)(C,{vaccineCenters:c})]})},L=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,24)).then((function(t){var c=t.getCLS,n=t.getFID,i=t.getFCP,s=t.getLCP,a=t.getTTFB;c(e),n(e),i(e),s(e),a(e)}))};a.a.render(Object(h.jsx)(i.a.StrictMode,{children:Object(h.jsx)(A,{})}),document.getElementById("root")),L()}},[[23,1,2]]]);
//# sourceMappingURL=main.2e7bc930.chunk.js.map