(this["webpackJsonpcovid-vaccine-notifier-v2"]=this["webpackJsonpcovid-vaccine-notifier-v2"]||[]).push([[0],[,,,,,,,,,,,,,,function(e,t,c){},,function(e,t,c){},function(e,t,c){},function(e,t,c){},,function(e,t,c){},function(e,t,c){"use strict";c.r(t);var n=c(1),i=c.n(n),a=c(5),s=c.n(a),l=(c(14),c(8)),r=c.n(l),o=c(3),j=c(9),d=c(2),b=(c(16),c(17),c(18),c(0));var u=function(e){var t=e.isPopupOpen,c=e.selectedCenter,n=e.closePopup,a=c.sessions;return t?(console.log(c),c.sessions.forEach((function(e){console.log(e)})),s.a.createPortal(Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:"overlay"}),Object(b.jsxs)("div",{className:"pop-up",children:[Object(b.jsx)("button",{onClick:n,children:"X"}),Object(b.jsx)("table",{className:"details-table",children:Object(b.jsxs)("tbody",{children:[Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"details-head",children:"Center:"}),Object(b.jsx)("td",{children:c.name})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"details-head",children:"Address:"}),Object(b.jsx)("td",{children:c.address})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"details-head",children:"Pincode:"}),Object(b.jsx)("td",{children:c.pincode})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"details-head",children:"Vaccine:"}),Object(b.jsx)("td",{children:c.sessions[0].vaccine})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"details-head",children:"Fee:"}),"Free"===c.fee_type?Object(b.jsx)("td",{children:"Free"}):Object(b.jsxs)("td",{children:["\u20b9",c.vaccine_fees[0].fee]})]})]})}),Object(b.jsxs)("div",{children:[Object(b.jsx)("h4",{children:"All Sessions"}),Object(b.jsxs)("table",{className:"all-sessions-table",children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{children:"Date"}),Object(b.jsx)("th",{children:"Min.Age"}),Object(b.jsx)("th",{children:"Dose 1"}),Object(b.jsx)("th",{children:"Dose 2"})]})}),Object(b.jsx)("tbody",{children:i.a.Children.toArray(a.map((function(e){return Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{children:e.date}),Object(b.jsx)("td",{children:e.min_age_limit}),Object(b.jsx)("td",{children:e.available_capacity_dose1}),Object(b.jsx)("td",{children:e.available_capacity_dose2})]})})))})]})]})]})]}),document.getElementById("modal-root"))):null};var h=function(e){var t=e.vaccineCenters,c=Object(n.useState)(!1),a=Object(d.a)(c,2),s=a[0],l=a[1],r=Object(n.useState)(""),j=Object(d.a)(r,2),h=j[0],O=j[1],f=Object(n.useState)(""),x=Object(d.a)(f,2),v=x[0],m=x[1],p=Object(n.useState)([]),g=Object(d.a)(p,2),N=g[0],C=g[1];return Object(n.useEffect)((function(){C("name"===v?Object(o.a)(t).sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})):function(e){return e.sort((function(e,t){return new Date(e.sessions[0].date)-new Date(t.sessions[0].date)}))}(Object(o.a)(t)))}),[v,t]),Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("table",{className:"vaccine-list-table",children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{className:"col col-1",onClick:function(){m("date")},children:"Date"}),Object(b.jsx)("th",{className:"col col-2",onClick:function(){m("name")},children:"Center"}),Object(b.jsx)("th",{className:"col col-3",children:"Dose 1"}),Object(b.jsx)("th",{className:"col col-4",children:"Dose 2"}),Object(b.jsx)("th",{className:"col col-5",children:"Min.Age"}),Object(b.jsx)("th",{className:"col col-6",children:"Vaccine"}),Object(b.jsx)("th",{className:"col col-7",children:"Type"})]})}),Object(b.jsxs)("tbody",{className:"vaccine-table-body",children:[i.a.Children.toArray(N.map((function(e){return Object(b.jsxs)("tr",{onClick:function(){l(!0),O(e)},children:[Object(b.jsx)("td",{className:"col col-1",children:e.sessions[0].date}),Object(b.jsx)("td",{className:"col col-2",children:Object(b.jsxs)("div",{children:[e.name,",",e.block_name,",",e.pincode]})}),Object(b.jsx)("td",{className:"col col-3",children:e.sessions[0].available_capacity_dose1}),Object(b.jsx)("td",{className:"col col-4",children:e.sessions[0].available_capacity_dose2}),Object(b.jsx)("td",{className:"col col-5",children:e.sessions[0].min_age_limit}),Object(b.jsx)("td",{className:"col col-6",children:e.sessions[0].vaccine}),Object(b.jsx)("td",{className:"col col-7",children:e.fee_type})]})}))),Object(b.jsx)(u,{isPopupOpen:s,selectedCenter:h,closePopup:function(){return l(!1)}})]})]})})};c(20);var O=function(e){var t=e.vaccineCenters,c=Object(n.useState)(0),i=Object(d.a)(c,2),a=i[0],s=i[1],l=Object(n.useState)("ALL"),r=Object(d.a)(l,2),j=r[0],u=r[1],O=Object(n.useState)(""),f=Object(d.a)(O,2),x=f[0],v=f[1],m=Object(n.useState)(0),p=Object(d.a)(m,2),g=p[0],N=p[1],C=Object(n.useState)("ALL"),y=Object(d.a)(C,2),k=y[0],w=y[1],F=Object(n.useState)([]),A=Object(d.a)(F,2),S=A[0],_=A[1],L=Object(n.useState)(!1),P=Object(d.a)(L,2),D=P[0],E=P[1];Object(n.useEffect)((function(){var e=function(e,t){if(0===e)return t;var c=new RegExp(e,"g");return t.filter((function(e){return c.exec(e.pincode)?e:null}))}(g,function(e,t){if(""===e)return t;var c=new RegExp(e,"gi");return t.filter((function(e){return c.exec(e.name)?e:null}))}(x,function(e,t){return"ALL"===e?t:t.filter((function(t){return t.sessions[0].vaccine===e?t:null}))}(j,function(e,t){return 0===e?t:t.filter((function(t){return t.sessions[0].min_age_limit===e?t:null}))}(a,function(e,t){return"ALL"===e?t:t.filter((function(t){return t.fee_type===e?t:null}))}(k,Object(o.a)(t))))));console.log(e[0]),D&&e.length>0&&(console.log("push notification"),"Notification"in window?"granted"===Notification.permission?new Notification("Vaccines are available!"):"denied"!==Notification.permission&&Notification.requestPermission().then((function(e){"granted"===e&&new Notification("Vaccines are available!")})):alert("This browser does not support desktop notification"),E(!1)),_(e)}),[a,j,x,g,t,D,k]);var I=function(e){u(e.target.value)},V=function(e){s(parseInt(e.target.value))},M=function(e){console.log(e.target.value),w(e.target.value)};return Object(b.jsxs)("div",{className:"VaccineCenterList",children:[Object(b.jsxs)("div",{className:"filter-container",children:[Object(b.jsxs)("div",{className:"radio-container",children:[Object(b.jsxs)("div",{className:"switch-field",children:[Object(b.jsx)("input",{type:"radio",id:"age-one",name:"age-radio",value:"0",onClick:V,defaultChecked:!0}),Object(b.jsx)("label",{htmlFor:"age-one",children:"All"}),Object(b.jsx)("input",{type:"radio",id:"age-two",name:"age-radio",value:"18",onClick:V}),Object(b.jsx)("label",{htmlFor:"age-two",children:"Age 18+"}),Object(b.jsx)("input",{type:"radio",id:"age-three",name:"age-radio",value:"40",onClick:V}),Object(b.jsx)("label",{htmlFor:"age-three",children:"Age 40+"}),Object(b.jsx)("input",{type:"radio",id:"age-four",name:"age-radio",value:"45",onClick:V}),Object(b.jsx)("label",{htmlFor:"age-four",children:"Age 45+"})]}),Object(b.jsxs)("div",{className:"switch-field",children:[Object(b.jsx)("input",{type:"radio",id:"vaccine-one",name:"vaccine-radio",value:"ALL",onClick:I,defaultChecked:!0}),Object(b.jsx)("label",{htmlFor:"vaccine-one",children:"All"}),Object(b.jsx)("input",{type:"radio",id:"vaccine-two",name:"vaccine-radio",value:"COVISHIELD",onClick:I}),Object(b.jsx)("label",{htmlFor:"vaccine-two",children:"Covishield"}),Object(b.jsx)("input",{type:"radio",id:"vaccine-three",name:"vaccine-radio",value:"COVAXIN",onClick:I}),Object(b.jsx)("label",{htmlFor:"vaccine-three",children:"Covaxin"}),Object(b.jsx)("input",{type:"radio",id:"vaccine-four",name:"vaccine-radio",value:"SPUTNIK V",onClick:I}),Object(b.jsx)("label",{htmlFor:"vaccine-four",children:"Sputnik"})]}),Object(b.jsxs)("div",{className:"switch-field",children:[Object(b.jsx)("input",{type:"radio",id:"fee-one",name:"fee-radio",value:"ALL",onClick:M,defaultChecked:!0}),Object(b.jsx)("label",{htmlFor:"fee-one",children:"All"}),Object(b.jsx)("input",{type:"radio",id:"fee-two",name:"fee-radio",value:"Free",onClick:M}),Object(b.jsx)("label",{htmlFor:"fee-two",children:"Free"}),Object(b.jsx)("input",{type:"radio",id:"fee-three",name:"fee-radio",value:"Paid",onClick:M}),Object(b.jsx)("label",{htmlFor:"fee-three",children:"Paid"})]})]}),Object(b.jsxs)("div",{className:"input-filter-container",children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{htmlFor:"name-filter",children:"Name"}),Object(b.jsx)("input",{type:"text",id:"name-filter",onChange:function(e){v(e.target.value)}})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{htmlFor:"pin-filter",children:"Pincode"}),Object(b.jsx)("input",{type:"number",id:"pin-filter",onChange:function(e){N(e.target.value)}})]})]})]}),Object(b.jsx)("div",{className:"vaccine-list-table",children:0!==S.length?Object(b.jsx)(h,{vaccineCenters:S}):Object(b.jsxs)("div",{className:"notification-prompt",children:[Object(b.jsx)("h4",{children:"No vaccine centers available!"}),Object(b.jsx)("button",{disabled:!!D,onClick:function(){E(!0)},children:"Notify Me !"})]})})]})},f=function(e){return e.filter((function(e){return e.available_capacity>0}))},x=function(e){var t=[];return e.forEach((function(e){var c=f(Object(o.a)(e.sessions));e.sessions=c,t.push(e)})),t.filter((function(e){return 0!==e.sessions.length}))};var v=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),c=t[0],i=t[1],a=function(){return Object(b.jsxs)("header",{children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:"Covid Vaccine Notifier"}),Object(b.jsx)("h6",{children:"Ernakulam"})]}),Object(b.jsx)("div",{className:"cowin-link",children:Object(b.jsx)("button",{children:Object(b.jsx)("a",{href:"https://selfregistration.cowin.gov.in/",children:"Co-WIN"})})})]})},s=function(){var e=new Date,t=String(e.getDate()),c=String(e.getMonth()+1),n=String(e.getFullYear());return e="".concat(t,"-0").concat(c,"-").concat(n)},l=function(){var e=Object(j.a)(r.a.mark((function e(){var t,c,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Vaccine Api fetch "),e.prev=1,e.next=4,fetch("https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/calendarByDistrict?district_id=307&date=".concat(s()),{mode:"cors"});case 4:return t=e.sent,e.next=7,t.json();case 7:c=e.sent,n=x(Object(o.a)(c.centers)),i(Object(o.a)(n)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){return console.log("useEffect API Fetch with interval 5000"),l(),setInterval((function(){l()}),1e7),function(){}}),[]),Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)(a,{}),Object(b.jsx)(O,{vaccineCenters:c})]})},m=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,22)).then((function(t){var c=t.getCLS,n=t.getFID,i=t.getFCP,a=t.getLCP,s=t.getTTFB;c(e),n(e),i(e),a(e),s(e)}))};s.a.render(Object(b.jsx)(i.a.StrictMode,{children:Object(b.jsx)(v,{})}),document.getElementById("root")),m()}],[[21,1,2]]]);
//# sourceMappingURL=main.dcb602c5.chunk.js.map